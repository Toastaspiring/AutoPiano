# UMP安定版だいたいの変更履歴
English version is in the [webpage](https://pipiraworld.web.fc2.com/ump/en.html#changelog-1.5)

# 1.5.1の変更点
- [再生終了&アンロード]が画面をクリアし情報オーバーレイをほぼリセットするようにしました。
- トラック色イベント(MIDI非標準)に(部分)対応しました。Zenithと挙動を合わせるつもりでしたが、再生の途中でも色が変わるというイケメンすぎる実装をZenithがしてしまい、UMPが完全対応してないみたいになってしまいました。こうなったのは英語が下手な僕の語弊のせいですが、ZenithはUMPとMIDIの開き方が違うので今から挙動を合わせようとしても合わせられないかもです。残！念！
- ベーシック診断で"トラックが大きすぎます"エラーが出るMIDIを診断したとき、テンポと長さが表示されるようにしました。
- 翻訳を調整したりしてくれたりしました。
- "時:分:秒"の時間表示で、"時"が実は10時間だったバグを修正しました。このバグ多分最初からありました(笑)

# 1.5の変更点

- 互換性の注意:
  - Config `updateChecker.branch` で使える値が変わりました。これまでの設定も使えますが非推奨です。
    - これまで: `RELEASE`, `BETA`
    - これから: `stable`, `development`
- 翻訳者向け:
  - 翻訳ファイルで言語名のパスが `lang` から `_lang` に変わりました。翻訳の他の変更は同梱の `.diff` ファイルをご覧ください。
  - 翻訳ファイルでの改行に `\n` が使えるようになりました。改行のためだけに翻訳をHTMLで囲うとかださいじゃん。
  - 翻訳ファイルに、その言語を表示できるフォントの情報をカンマ区切りで含められるようになりました。

- 中国語訳を搭載しました。
- MIDIファイルが入ったzipファイルをzipのまま開けるようになりました。が、開けないzipも多いので素直に解凍したほうがいいかもしれません…
- 右からノートが流れてきて光るMIDITr○ilみたいな新レンダラー `HorizontalMIDIRenderer` を追加しました。
- テンポとノートを表示する、基本情報のみオーバーレイを追加しました。ちなみにテンポの前の音符記号は♩( `U+2669` )です。
- オーバーレイの場所を変えられるようにしました。
- 動画出力ダイアログにffmpegのリンクを追加しました。要らないと思うけど違和感ないのでつけたままリリース。
- After EffectsがAVIを開けないことが発覚したので、MOV出力を追加しました。だが俺のAfter Effectsはここまでのようだ！(☆無料期間終了☆)
- 動画出力で出力先のファイル名を選べるようにしました。
- 動画出力中、プレビューをダブルクリックするとリサイズ可能なプレビューウィンドウが出るようにしました。
- [表示]→[クイックリサイズ]を追加しました。よく使う解像度に合うように一発でウィンドウをリサイズできます。モニターよりでかい解像度は選べないようになっています。
- Configを直接開かなくてもフォントを変えられるダイアログ([設定]→[フォント])を追加しました。
- Configを直接開かなくても言語を変えられるダイアログ([設定]→[言語])を追加しました。
- ようこそウィンドウがキーボード操作に対応しました。矢印とタブで言語とシンセを選び、Enterで進みます。
- ようこそウィンドウにロード画面を追加しました。シンセなどのロード中にメインウィンドウが固まるのが嫌だったので。
- キーボードショートカットを追加しました:
  - UMPについて (F1)

- デフォルト系レンダラーの黒鍵の位置を微妙にずらしました。
- 動画出力中、進捗が0%の間は残り時間を表示しないようにしました。
- シングルスレッドMIDI読み込みを使っていると動画出力ダイアログのプログレスバーが消えていた見た目の問題を修正しました。
- 動画出力中、ごくまれに出力速度がマイナスになっていた見た目の問題を修正しました。
- リソパダイアログを結構きれいにしました:
  - 壊れたパックも表示できるようになりました。
  - パック一覧に区切り線をつけました。
  - プレビュー用レンダラーの描画間隔を固定しました。
  - プレビューに高密度ノートを追加しました。
  - 非対応パックを選択する前に出るダイアログをきれいにしました。
- [フォント]ダイアログで[プレビュー]を押したときフォントリストがそのフォントまでスクロールするようにしました。
- [UMPについて]ダイアログのキャッチコピー的なやつを変えました。
- エラーダイアログとエラーレポートをきれいにしました。
- 翻訳を全体的にきれいにし、英語は大文字の置き方を変更・統一しました。
- ウィンドウをリサイズしてメニューバーにカーソルを置くとメニューバーが消えていた見た目の問題を修正しました。
- ようこそウィンドウで言語とシンセを複数選択できていた見た目の問題を修正しました。
- その他、アップデートダイアログをリサイズ不可にするなどの小さな調整。

- マルチスレッドMIDI読み込みがトラックを読み込む順番を固定したと思います。リソパ勢、喜べ！
- どういうわけかテンポが無限のMIDIでUMPを固めるのが流行っているらしいので、無限テンポが診断とMIDI読み込みを中断させるようにしました。
- Config `midi.usePlayThread` を `false` にしてシンセ無しで起動すると再生できなかったバグを修正しました。
- 再生速度ダイアログだと1%まで下げられるのに、実際の再生速度は10%までしか下がらなかったバグを修正しました。このバグ1.2からありました(笑)
- 再生停止時に映っていたノートの一部が次の再生時に出現していたバグを修正しました。
- NPSの表示が実際の値と若干ずれることがあったので、正確に計算するようにしました。
- 動画出力ダイアログを閉じずに2回目の出力をさせると、速度制限がリセットされていたバグを修正しました。
- ごくごく稀に、診断ダイアログの表示更新が、診断が終わる直前で止まっていたバグを修正しました。
- Configの読み込みに失敗したときようこそウィンドウに出てくる、Configをリセットするかのオプションがほとんど意味なかったので削除し、バックアップするオプションを追加しました。
- config.ymlに保存される設定がアルファベット順にならないようにしました。
- UMPの誕生日にウィンドウタイトルが変わるようにしました。スペシャルタイトルは全部で4つになりました。
- コードをめっちゃリファクタしました。
- コンソール出力をほんの少し変えたけど誰も気にしない。
- バッチファイルも更新したけど誰も気にしない。

## 1.4.1の変更点
- 疑似フルスクリーンにメニューバーを追加しました。
  - カーソルを上に持っていくと表示されます。
  - これにより、疑似フルスクリーンでもショートカットキーが使えるようになりました。
  - これに伴い、F11キーは疑似フルスクリーンの終了もできるようにしました。
- 診断にテンポを追加しました。
- 描画バッファの作り方を変えました。
  - これにより、一部の古いOSやLinux系でもUMPが動くなるようになります。たぶん。
  - パフォーマンスの低下を感じたらお知らせください。戻します。
- 全てのレンダラーを、MIDIが終了した後も1秒描画し続けるようにしました。
  - これにより、どんなMIDIでも、NPSが0になるまで動画が続きます。
- MIDIスレッド時間オーバーレイのグラフ縦軸をだいぶ拡大しました。
- FPSオーバーレイのサイズをちょっと変えました。
- [config.ymlを開く]を[UMPフォルダを開く]に変更しました。
  - これにより、Configを編集したあとUMPを閉じたら上書きされる事件を防げます。
- [動画をつくる]のffmpeg選択ダイアログで[ファイルのタイプ]が空白だったのを"すべてのファイル"に修正しました。
- 描画間隔が極端に低い時、ノートの高さがおかしくなっていた問題の修正に3度目の挑戦をしました。

## 1.4の変更点
- 診断を新しくしました。
  - 黒MIDI診断を追加しました。
- Configも新しくしました。
  - 一部のオプションと前回開いたMIDIファイルパスも保存するようにしました。
- [mp4に保存]も新しくし、名前も[動画をつくる]に変えました。
  - AVIに対応しました。
  - 出力速度制限を追加しました。
- [リソースパック]も新しくしました。
  - プレビューを追加しました。
- [UMPについて]も新しくしました。
- [ファイル]→[開き直す]を追加しました。
- キーボードショートカットをさらに追加しました。
  - 開き直す (Ctrl+Shift+R)
  - 診断 (Ctrl+D)
  - 再生し直す (Ctrl+R)
  - 擬似フルスクリーン (F11)
- FPSカウンターと同じように、MIDIスレッド時間オーバーレイも数だけの表示ができるようにしました。
- [動画をつくる]がUMPフォルダにあるffmpegを自動選択するようにしました。
- 翻訳できるダイアログボタンを増やしました(エラーダイアログの[Continue]など)。
- 解像度制限の幅を3840から4096に緩和しました。
- UMPのダイアログはたぶん全部Escキーで閉じられるようにしました。

## 1.3の変更点
- リソースパックを追加しました。
- レンダラーを追加しました。
- [描画無しで再生]を追加しました。
- [ノートカウント&MIDI診断]を追加しました。
- 疑似フルスクリーンを追加しました。
- ようこそウィンドウを追加しました。
- MIDITrain風情報表示にNPSを追加しました。
- [発射]を追加しました。
- 情報表示を拡大できるようにしました。
- FPSカウンターの平均を最後の1秒のフレーム数に変更しました。
- MIDIをマルチスレッドで読み込めるようにしました。
- ノートをシンセに送る処理を別スレッドに移動しました。
  - 高NPS時、音ズレが訪れる代わりにFPSの復活が早くなります。
- MIDIスレッド時間オーバーレイを追加しました。
- 解像度制限を4Kに緩和しました。
- mp4保存に解像度オプションを追加しました。
- ウィンドウリサイズで解像度を変えられるようにしました。
- メニューをきれいにしました。
- エラーレポートを詳しくしました。
- mp4保存の出力がおかしかったのを修正しました。
  - これにより、mp4保存がほぼ最速になりました。
- 全ノートが1px厚かったのを修正しました。
- mp4保存にテキストアンチエイリアスがなかったのを修正しました。

## 1.2.2の変更点
- エラーレポートを追加しました。
- mp4保存を速くしましたが、出力がおかしくなりました。
- mp4保存のおかしい出力を直すため、一時的にピクセルフォーマットオプションを追加しました。
- mp4保存にビットレートオプションを追加しました。
- mp4保存のファイル名から `.mid` 拡張子を消しました。
- mp4保存の前に、同名ファイルがある場合確認するようにしました。
- 言語設定にかかわらず、デフォルトの日本語を先に読み込むようにしました。

## 1.2の変更点
- ショートカットキーを追加しました。
- →キーで再生を1秒飛ばせるようにしました。
- 固定ノート色を16に減らし、17トラック目以降をランダム色にしました。
- 各トラックをイベントチャンネルでさらに分割するようにしました。
- PFAのConfigからノート色を読み込むオプションをConfigに追加しました。
- 描画間隔プレビューをきれいにしました。
- MIDI読み込みの進捗を細かくしました。

# 1.1の変更点
スクリーンショットから発掘しましたが、いくつか欠けているかもです。
Web Archiveで探しましたが完全版はありませんでした☆

- メモリ消費量がほんの少し減りました(環境によりますが、1ノートにつき約5バイト)。
- mp4保存でlibx265が使えるようになりました。
- mp4保存を止められるようになりました。
- 描画が軽いときだけFPSがさらに上がる、全く嬉しくないパフォーマンス改善。
- 微調整とバグ修正。
